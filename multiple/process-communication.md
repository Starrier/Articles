---
title: 'process communication '
date: 2019-02-15 20:58:44
tags: Thread
index_img: ../post_img/IPC.jpeg
---

## 进程间通信

进程间通信(IPC,InterProcessCommunication) 是指在不同进程之间传播或交换信息。

IPC 的方式通常有管道（包括无名管道和命名管道）、消息队列、信号量、共享存储、Socket、Streams 等。其中 Socket 和 Streams 支持不同主机上的两个进程 IPC。

### 1. **管道**

管道，通常指无名管道，是 UNIX 系统 IPC 最古老的的形式。

#### 特点

 1. 它是半双工的（即数据只能在一个方向上流动）具有固定的读端和写端。
 2. 它只能用于具有亲缘关系的进程之间的通信（父子进行或者兄弟进程之间）。
 3. 它可以看成是一种特殊的文件，对于它的读写也可以使用普通的 read、write 等函数。但是它不是普通的文件，并不属于其他任何文件系统，并且只存在于内存中。

#### 原型

### 2. **FIFO**

FIFO(命名管道)，是一种文件类型

#### 特点

 1. FIFO 可以在无关的进程之间交换数据，与无名管道不同。
 2. FIFO 有路径名与之相关联，它以一种特殊设备文件形式存在于文件系统中。


### 3. **消息队列**

 消息队列，是消息的链接表，存放在内核中。一个消息队列由一个标识符（即队列 ID）来标识。

#### 特点

  1. 消息队列是面向记录的，其中的消息具有特定的格式以及特定的优先级。
  2. 消息队列独立于发送与接收进程。进程终止时，消息队列及其内容并不会被删除。
  3. 消息队列可以实现消息的随机查询，消息不一定要以先进先出的次序读取，也可以按消息的类型读取。


### 4. **信号量**

信号量(Semaphore) 与已经介绍的 IPC 结果不同，它是一个计数器。信号量用于实现进程间的互斥与同步，而不是用于存储进程间通信数据。

#### 特点

 1. 信号量用于进程间同步，若要进程间传递数据，需要集合内存共享。
 2. 信号量基于操作系统的 PV 操作，程序对信号量的操作都是原子操作。
 3. 每次对信号量的 PV 操作，不仅限于对信号量值加 1 或 减 1，而且可以加减任意正整数。
 4. 支持信息量组


最简单的信号量是只能取 0 或 1 的变量，这也是信号量最常见的形式，叫做二值信号量(Binary Semaphore)。而可以取多个正整数的信号量称为通用信号量。

Linux 下的信号量函数都是在通用的信号量数组上进行操作的，而不是在一个的那一刻的二值信号量上进行操作。

``` C++
 #include<sys/sem.hm>

 int segm
```

### 5. **共享内存**

共享内存(Shared Memory)，指两个或多个进程共享一个给定的存储区。

#### 特点

 1. 共享内存是最快的一种 IPC，因为进程是直接对内存进程存取。
 2. 因为多个进程可以同时操作，所以需要进行同步。
 3. 信号量 + 共享内存通常结合在一起使用，信号量用来同步对共享内存的访问。


## 总结

  1. 管道：速度快，容量有限，只有父子进程可以通讯。
  2. FIFO： 任何进程间都能通信，但速度慢。
  3. 消息队列：容量受到系统限制，且要注意第一次读的时候，要考虑上一次有没有读完书籍的问题。
  4. 信号量： 不能传递复杂数据，只能用来同步。
  5. 共享内存：能够很容易控制容量，速度快，但要保持同步，比如一个进程在写的时候，另一个进程要注意读写问题，相当于线程中的线程安全。共享内存区同样可以用作线程间通信。但线程本身就已经共享了同一进程内的一块内存。

